# E-Ticaret API Projesi

Bu proje, Laravel ve PostgreSQL kullanılarak geliştirilmiş bir e-ticaret API'sidir. JWT token tabanlı authentication sistemi ile güvenli API endpoint'leri sunar.

## Teknik Gereksinimler

- PHP 8.0+
- PostgreSQL 13+
- Laravel 9.x
- Composer

## Kurulum Adımları

### 🐳 Docker ile Kurulum (Önerilen)

#### 1. Projeyi Klonlayın
```bash
git clone <repository-url>
cd Ecom
```

#### 2. Docker Kurulum Scriptini Çalıştırın
```bash
chmod +x docker-setup.sh
./docker-setup.sh
```

#### 3. Manuel Docker Kurulumu (Alternatif)
```bash
# Containers'ları build et ve başlat
docker-compose up -d --build

# Dependencies yükle
docker-compose exec app composer install

# Application key oluştur
docker-compose exec app php artisan key:generate

# JWT secret oluştur
docker-compose exec app php artisan jwt:secret

# Migration'ları çalıştır
docker-compose exec app php artisan migrate

# Sample data yükle
docker-compose exec app php artisan db:seed --class=SampleDataSeeder
```

### 💻 Manuel Kurulum

#### 1. Projeyi Klonlayın
```bash
git clone <repository-url>
cd Ecom
```

#### 2. Bağımlılıkları Yükleyin
```bash
composer install
```

#### 3. Environment Dosyasını Oluşturun
```bash
cp .env.example .env
```

#### 4. Environment Değişkenlerini Düzenleyin
`.env` dosyasında PostgreSQL bağlantı bilgilerini güncelleyin:

```env
DB_CONNECTION=pgsql
DB_HOST=127.0.0.1
DB_PORT=5432
DB_DATABASE=ecom_api
DB_USERNAME=postgres
DB_PASSWORD=your_postgres_password
```

#### 5. Application Key Oluşturun
```bash
php artisan key:generate
```

#### 6. JWT Secret Oluşturun
```bash
php artisan jwt:secret
```

#### 7. Veritabanını Oluşturun
PostgreSQL'de veritabanını oluşturun:
```sql
CREATE DATABASE ecom_api;
```

#### 8. Migration'ları Çalıştırın
```bash
php artisan migrate
```

#### 9. Sample Data'yı Yükleyin
```bash
php artisan db:seed --class=SampleDataSeeder
```

#### 10. Sunucuyu Başlatın
```bash
php artisan serve
```

## API Endpoint'leri

### Authentication

#### POST /api/register
Kullanıcı kaydı
```json
{
    "name": "John Doe",
    "email": "john@example.com",
    "password": "password123"
}
```

#### POST /api/login
Kullanıcı girişi
```json
{
    "email": "john@example.com",
    "password": "password123"
}
```

#### GET /api/profile
Kullanıcı profili görüntüleme (Token gerekli)

#### PUT /api/profile
Kullanıcı profili güncelleme (Token gerekli)
```json
{
    "name": "John Updated",
    "email": "john.updated@example.com"
}
```

#### POST /api/logout
Çıkış yapma (Token gerekli)

### Kategoriler

#### GET /api/categories
Tüm kategorileri listele (Token gerekli)

#### POST /api/categories
Yeni kategori oluştur (Token gerekli)
```json
{
    "name": "Yeni Kategori",
    "description": "Kategori açıklaması"
}
```

#### GET /api/categories/{id}
Kategori detayı (Token gerekli)

#### PUT /api/categories/{id}
Kategori güncelle (Token gerekli)

#### DELETE /api/categories/{id}
Kategori sil (Token gerekli)

### Ürünler

#### GET /api/products
Ürünleri listele (Token gerekli)

**Query Parametreleri:**
- `page`: Sayfa numarası
- `limit`: Sayfa başına kayıt sayısı (varsayılan: 20)
- `category_id`: Kategori filtresi
- `min_price`: Minimum fiyat
- `max_price`: Maksimum fiyat
- `search`: Ürün adında arama

#### POST /api/products
Yeni ürün ekle (Token gerekli)
```json
{
    "name": "Yeni Ürün",
    "description": "Ürün açıklaması",
    "price": 99.99,
    "stock_quantity": 50,
    "category_id": 1
}
```

#### GET /api/products/{id}
Ürün detayı (Token gerekli)

#### PUT /api/products/{id}
Ürün güncelle (Token gerekli)

#### DELETE /api/products/{id}
Ürün sil (Token gerekli)

### Sepet

#### GET /api/cart
Sepeti görüntüle (Token gerekli)

#### POST /api/cart/add
Sepete ürün ekle (Token gerekli)
```json
{
    "product_id": 1,
    "quantity": 2
}
```

#### PUT /api/cart/update
Sepet ürün miktarı güncelle (Token gerekli)
```json
{
    "product_id": 1,
    "quantity": 3
}
```

#### DELETE /api/cart/remove/{product_id}
Sepetten ürün çıkar (Token gerekli)

#### DELETE /api/cart/clear
Sepeti temizle (Token gerekli)

### Siparişler

#### GET /api/orders
Kullanıcının siparişlerini listele (Token gerekli)

#### POST /api/orders
Sipariş oluştur (Token gerekli)

#### GET /api/orders/{id}
Sipariş detayı (Token gerekli)

## Response Format

Tüm API response'ları aşağıdaki formatı kullanır:

```json
{
    "success": true,
    "message": "İşlem başarılı",
    "data": {},
    "errors": []
}
```

## HTTP Status Kodları

- `200`: Başarılı işlem
- `201`: Oluşturma başarılı
- `400`: Geçersiz istek
- `401`: Yetkisiz erişim
- `404`: Bulunamadı
- `422`: Validasyon hatası
- `500`: Sunucu hatası

## Test Kullanıcıları

Seeder ile oluşturulan test kullanıcıları:

### Admin Kullanıcısı
- **Email:** admin@test.com
- **Password:** admin123
- **Role:** admin

### Normal Kullanıcı
- **Email:** user@test.com
- **Password:** user123
- **Role:** user

## Authentication

API'yi kullanmak için JWT token gereklidir. Token'ı almak için:

1. `/api/register` veya `/api/login` endpoint'ini kullanın
2. Response'dan `data.token` değerini alın
3. Sonraki isteklerde `Authorization` header'ında `Bearer {token}` formatında gönderin

**Örnek:**
```
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
```

## Özellikler

- ✅ JWT Token Authentication
- ✅ Kullanıcı Yönetimi (Kayıt, Giriş, Profil)
- ✅ Kategori Yönetimi (CRUD)
- ✅ Ürün Yönetimi (CRUD)
- ✅ Sepet Yönetimi
- ✅ Sipariş Yönetimi
- ✅ Stok Kontrolü
- ✅ Filtreleme ve Sayfalama
- ✅ Validasyon
- ✅ Error Handling
- ✅ PostgreSQL Veritabanı
- ✅ Sample Data

## Güvenlik

- Şifreler bcrypt ile hash'lenir
- JWT token tabanlı authentication
- Input validasyonu
- SQL injection koruması
- XSS koruması

## 🐳 Docker Komutları

### Container Yönetimi
```bash
# Containers'ları başlat
docker-compose up -d

# Containers'ları durdur
docker-compose down

# Containers'ları yeniden başlat
docker-compose restart

# Log'ları görüntüle
docker-compose logs -f

# Belirli bir service'in log'larını görüntüle
docker-compose logs -f app
```

### Laravel Komutları (Docker içinde)
```bash
# Artisan komutları
docker-compose exec app php artisan migrate
docker-compose exec app php artisan db:seed
docker-compose exec app php artisan cache:clear

# Composer komutları
docker-compose exec app composer install
docker-compose exec app composer update

# Yeni dosyalar oluşturma
docker-compose exec app php artisan make:controller Api/NewController
docker-compose exec app php artisan make:model NewModel -m
docker-compose exec app php artisan make:seeder NewSeeder
```

### Veritabanı İşlemleri
```bash
# PostgreSQL'e bağlan
docker-compose exec postgres psql -U postgres -d ecom_api

# Database backup
docker-compose exec postgres pg_dump -U postgres ecom_api > backup.sql

# Database restore
docker-compose exec -T postgres psql -U postgres -d ecom_api < backup.sql
```

## 💻 Geliştirme

### Yeni Migration Oluşturma
```bash
# Docker ile
docker-compose exec app php artisan make:migration create_table_name

# Manuel
php artisan make:migration create_table_name
```

### Yeni Model Oluşturma
```bash
# Docker ile
docker-compose exec app php artisan make:model ModelName -m

# Manuel
php artisan make:model ModelName -m
```

### Yeni Controller Oluşturma
```bash
# Docker ile
docker-compose exec app php artisan make:controller Api/ControllerName

# Manuel
php artisan make:controller Api/ControllerName
```

### Yeni Seeder Oluşturma
```bash
# Docker ile
docker-compose exec app php artisan make:seeder SeederName

# Manuel
php artisan make:seeder SeederName
```

